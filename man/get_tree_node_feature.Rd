% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_overwrite_ptime_1.R
\name{get_tree_node_feature}
\alias{get_tree_node_feature}
\title{Extract features (expression or proportion) for each node in the cell type tree}
\usage{
get_tree_node_feature(
  leaves_info,
  features = c("expr", "prop"),
  raw_count,
  cell_meta,
  filter_pct = 0.9,
  HVG = F,
  qnorm = F,
  batch_correction = F,
  batch = NULL,
  clr = F,
  adj_cov = NULL,
  parallel = T,
  num_cores = 10
)
}
\arguments{
\item{leaves_info}{Data frame containing tree structure information for leaf nodes}

\item{features}{Type of features to extract - either 'expr' (expression) or 'prop' (proportion)}

\item{raw_count}{Raw count matrix with genes as rows and cells as columns}

\item{cell_meta}{Cell metadata containing barcode, sample, and celltype information}

\item{filter_pct}{Minimum percentage of samples required (default: 0.9)}

\item{HVG}{Whether to identify highly variable genes (default: FALSE)}

\item{qnorm}{Whether to quantile normalize data (default: FALSE)}

\item{batch_correction}{Whether to perform batch correction (default: FALSE)}

\item{batch}{Optional batch information for correction}

\item{clr}{Whether to perform centered log-ratio transformation (default: FALSE)}

\item{adj_cov}{Additional covariates for adjustment (default: NULL)}

\item{parallel}{Whether to use parallel processing (default: TRUE)}

\item{num_cores}{Number of cores for parallel processing (default: 10)

Returns:
For expression features:
\itemize{
\item hvg: List of highly variable genes per node
\item agg: Aggregated features across tree levels
\item all: All features for each node
}

For proportion features:
\itemize{
\item List of cell type proportions for each tree level
}}
}
\description{
Parameters:
}
