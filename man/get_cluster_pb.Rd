% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util.R
\name{get_cluster_pb}
\alias{get_cluster_pb}
\title{Generates pseudobulk data from single-cell expression data by aggregating cells within clusters and samples}
\usage{
get_cluster_pb(
  s,
  clu,
  pt,
  topclu = NULL,
  batch = NULL,
  HVG = T,
  qnorm = F,
  combat = F,
  preserve_zero = T
)
}
\arguments{
\item{s}{List of expression matrices or single expression matrix}

\item{clu}{Vector of cluster labels for each cell}

\item{pt}{Vector of sample/patient IDs for each cell}

\item{topclu}{Subset of clusters to analyze (default: all clusters)}

\item{batch}{Vector of batch labels for batch correction}

\item{HVG}{Whether to identify highly variable genes (default: TRUE)}

\item{qnorm}{Whether to perform quantile normalization (default: FALSE)}

\item{combat}{Whether to perform ComBat batch correction (default: FALSE)}

\item{preserve_zero}{Whether to preserve zeros in quantile normalization (default: TRUE)

Returns:
List containing:
\itemize{
\item all: Complete pseudobulk expression matrix
\item hvg: Pseudobulk expression matrix for highly variable genes only
}}
}
\description{
Parameters:
}
