% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_clean.R
\name{runPseudoAnalysis}
\alias{runPseudoAnalysis}
\title{Performs comprehensive pseudotime analysis including trajectory inference and differential expression}
\usage{
runPseudoAnalysis(
  raw_count,
  cell_meta,
  sample_meta,
  leaves_info,
  features = "expr_and_prop",
  batch = NULL,
  pb_filter_pct = 0.9,
  pb_HVG = T,
  pb_qnorm = T,
  pb_batch_correction = F,
  pb_parallel = F,
  num_cores = 10,
  ctp_clr = F,
  ctp_adj_cov = NULL,
  ctp_batch_correction = F,
  sample_name = "sample",
  severity_name = "severity",
  severity_num_name = "sev.level",
  ptime_method = "cca",
  clustermethod = "louvain",
  cluster_id = NULL,
  reduce = F,
  clusternum = 2,
  startcluster = 1,
  near_nbr_num = 3,
  modelNames = "VVV",
  pc_scale = T,
  eval_method = "corr",
  pseudotime_name = "pseudotime",
  gene_mapping = F,
  deg_parallel = F,
  deg_num_cores = 10,
  save_deg = F,
  sample_embed_plot = F,
  result_path = "./result/"
)
}
\arguments{
\item{raw_count}{Matrix of raw gene expression counts (genes x cells)}

\item{cell_meta}{Data frame with cell-level metadata}

\item{sample_meta}{Data frame with sample-level metadata}

\item{leaves_info}{Data frame containing hierarchical clustering tree information}

\item{features}{Type of features to use ('expr_and_prop' for both expression and proportions)}

\item{batch}{Optional batch information for correction}

\item{pb_filter_pct}{Minimum percentage of samples required for pseudobulk analysis (default: 0.9)}

\item{pb_HVG}{Whether to use highly variable genes for pseudobulk (default: TRUE)}

\item{pb_qnorm}{Whether to quantile normalize pseudobulk data (default: TRUE)}

\item{pb_batch_correction}{Whether to perform batch correction on pseudobulk (default: FALSE)}

\item{pb_parallel}{Whether to parallelize pseudobulk computation (default: FALSE)}

\item{num_cores}{Number of cores for parallel processing (default: 10)}

\item{ctp_clr}{Whether to apply CLR transformation to cell type proportions (default: FALSE)}

\item{ctp_adj_cov}{Optional covariates to adjust in cell type proportions}

\item{ctp_batch_correction}{Whether to correct batch effects in proportions (default: FALSE)}

\item{sample_name}{Column name for sample IDs (default: 'sample')}

\item{severity_name}{Column name for severity category (default: 'severity')}

\item{severity_num_name}{Column name for numerical severity (default: 'sev.level')}

\item{ptime_method}{Method for pseudotime ('cca' or 'tscan', default: 'cca')}

\item{clustermethod}{Clustering method for TSCAN (default: 'louvain')}

\item{cluster_id}{Optional pre-defined cluster assignments}

\item{reduce}{Whether to reduce dimensions before analysis (default: FALSE)}

\item{clusternum}{Number of clusters for TSCAN (default: 2)}

\item{startcluster}{Starting cluster for TSCAN (default: 1)}

\item{near_nbr_num}{Number of nearest neighbors for graph construction (default: 3)}

\item{modelNames}{Model type for mclust clustering (default: 'VVV')}

\item{pc_scale}{Whether to scale PCs (default: TRUE)}

\item{eval_method}{Method to evaluate pseudotime quality (default: 'corr')}

\item{pseudotime_name}{Column name for pseudotime values (default: 'pseudotime')}

\item{gene_mapping}{Whether to map genes to standard identifiers (default: FALSE)}

\item{deg_parallel}{Whether to parallelize differential expression (default: FALSE)}

\item{deg_num_cores}{Number of cores for parallel DEG analysis (default: 10)}

\item{save_deg}{Whether to save DEG results to files (default: FALSE)}

\item{sample_embed_plot}{Whether to generate sample embedding plots (default: FALSE)}

\item{result_path}{Path to save results (default: './result/')

Returns:
List containing:
\itemize{
\item sample_meta_ptime: Sample metadata with pseudotime
\item ptime.ls: Pseudotime analysis results
\item pb.ls: Pseudobulk analysis results
\item deg_table: Differential expression results
\item deg_summary: Summary of differential expression analysis
}}
}
\description{
Parameters:
}
