% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_clean.R
\name{runPseudotime}
\alias{runPseudotime}
\title{Main function for running pseudotime analysis on single-cell data using expression or proportion features}
\usage{
runPseudotime(
  raw_count,
  cell_meta,
  sample_meta,
  leaves_info,
  features = "expr_and_prop",
  batch = NULL,
  pb_filter_pct = 0.9,
  pb_HVG = T,
  pb_qnorm = T,
  pb_batch_correction = F,
  pb_parallel = F,
  num_cores = 10,
  ctp_clr = F,
  ctp_adj_cov = NULL,
  ctp_batch_correction = F,
  sample_name = "sample",
  severity_name = "severity",
  severity_num_name = "sev.level",
  ptime_method = "cca",
  clustermethod = "louvain",
  cluster_id = NULL,
  reduce = F,
  clusternum = 2,
  startcluster = 1,
  near_nbr_num = 3,
  modelNames = "VVV",
  pc_scale = T,
  eval_method = "corr"
)
}
\arguments{
\item{raw_count}{Matrix of raw gene expression counts (genes x cells)}

\item{cell_meta}{Data frame of cell metadata including cell type annotations}

\item{sample_meta}{Data frame of sample-level metadata}

\item{leaves_info}{Tree structure information for cell type hierarchy}

\item{features}{Type of features to use: 'expr', 'prop', or 'expr_and_prop'}

\item{batch}{Optional batch information for correction}

\item{pb_filter_pct}{Proportion of samples required for pseudobulk analysis (default: 0.9)}

\item{pb_HVG}{Whether to use highly variable genes (default: TRUE)}

\item{pb_qnorm}{Whether to quantile normalize data (default: TRUE)}

\item{pb_batch_correction}{Whether to perform batch correction on pseudobulk (default: FALSE)}

\item{pb_parallel}{Whether to parallelize pseudobulk computation (default: FALSE)}

\item{num_cores}{Number of cores for parallel processing (default: 10)}

\item{ctp_clr}{Whether to CLR transform proportions (default: FALSE)}

\item{ctp_adj_cov}{Additional covariates for proportion adjustment}

\item{ctp_batch_correction}{Whether to correct batch effects in proportions (default: FALSE)}

\item{sample_name}{Column name for sample IDs (default: 'sample')}

\item{severity_name}{Column name for severity category (default: 'severity')}

\item{severity_num_name}{Column name for numerical severity (default: 'sev.level')}

\item{ptime_method}{Method for pseudotime: 'cca' or 'tscan' (default: 'cca')}

\item{clustermethod}{Clustering method for TSCAN (default: 'louvain')}

\item{cluster_id}{Pre-defined cluster assignments}

\item{reduce}{Whether to reduce dimensions (default: FALSE)}

\item{clusternum}{Number of clusters for TSCAN (default: 2)}

\item{startcluster}{Starting cluster for TSCAN path (default: 1)}

\item{near_nbr_num}{Number of neighbors for graph construction (default: 3)}

\item{modelNames}{Model type for mclust (default: 'VVV')}

\item{pc_scale}{Whether to scale PCs (default: TRUE)}

\item{eval_method}{Method for evaluating pseudotime quality (default: 'corr')}
}
\value{
List containing:
\itemize{
\item pb.ls: Pseudobulk expression data
\item ctp.ls: Cell type proportion data
\item ptime.ls: Pseudotime ordering results
\item sample_meta_ptime: Sample metadata with pseudotime values
}
}
\description{
Main function for running pseudotime analysis on single-cell data using expression or proportion features
}
