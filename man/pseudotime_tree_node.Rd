% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_overwrite_ptime_2.R
\name{pseudotime_tree_node}
\alias{pseudotime_tree_node}
\title{Constructs pseudotime ordering for cell types in a hierarchical tree structure}
\usage{
pseudotime_tree_node(
  leaves_info,
  features = c("expr", "prop"),
  raw_count,
  cell_meta,
  pb.ls,
  ctp.ls,
  sample_metadata = NULL,
  sample_name = "sample",
  severity_name = "severity",
  severity_num_name = "sev.level",
  ptime_method = c("tscan", "cca"),
  cluster = NULL,
  reduce = F,
  clusternum = 2,
  clustermethod = "mclust",
  startcluster = 1,
  modelNames = "VVV",
  near_nbr_num = 10,
  pc_scale = F
)
}
\arguments{
\item{leaves_info}{Data frame with tree structure information (label, y, children columns)}

\item{features}{Feature type to analyze - either 'expr' (gene expression) or 'prop' (cell proportions)}

\item{raw_count}{Raw count matrix for expression data}

\item{cell_meta}{Cell-level metadata including barcode, sample, celltype}

\item{pb.ls}{List of pseudobulk data for expression analysis}

\item{ctp.ls}{List of cell type proportions for proportion analysis}

\item{sample_metadata}{Sample-level metadata}

\item{sample_name}{Column name for sample IDs (default: 'sample')}

\item{severity_name}{Column name for severity category (default: 'severity')}

\item{severity_num_name}{Column name for numerical severity (default: 'sev.level')}

\item{ptime_method}{Method for pseudotime - 'tscan' or 'cca'}

\item{cluster}{Optional pre-defined cluster assignments}

\item{reduce}{Whether to reduce dimensions (default: FALSE)}

\item{clusternum}{Number of clusters for TSCAN (default: 2)}

\item{clustermethod}{Clustering method - 'mclust', 'kmeans', or 'louvain'}

\item{startcluster}{Starting cluster for TSCAN (default: 1)}

\item{modelNames}{Model type for mclust (default: 'VVV')}

\item{near_nbr_num}{Number of nearest neighbors (default: 10)}

\item{pc_scale}{Whether to scale PCA (default: FALSE)

Returns:
List containing pseudotime analysis results for each tree level:
\itemize{
\item For expression data: PCA coordinates, pseudotime ordering
\item For proportion data: PCA coordinates, pseudotime ordering
}}
}
\description{
Parameters:
}
